<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fh.taolijie.dao.mapper.JobPostModelMapper" >
  <resultMap id="BaseResultMap" type="com.fh.taolijie.domain.JobPostModel" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="expired_time" property="expiredTime" jdbcType="DATE" />
    <result column="post_time" property="postTime" jdbcType="DATE" />
    <result column="work_place" property="workPlace" jdbcType="VARCHAR" />
    <result column="wage" property="wage" jdbcType="DECIMAL" />
    <result column="time_to_pay" property="timeToPay" jdbcType="VARCHAR" />
    <result column="job_description" property="jobDescription" jdbcType="VARCHAR" />
    <result column="contact" property="contact" jdbcType="VARCHAR" />
    <result column="contact_phone" property="contactPhone" jdbcType="VARCHAR" />
    <result column="contact_email" property="contactEmail" jdbcType="VARCHAR" />
    <result column="contact_qq" property="contactQq" jdbcType="VARCHAR" />
    <result column="job_detail" property="jobDetail" jdbcType="VARCHAR" />
    <result column="likes" property="likes" jdbcType="INTEGER" />
    <result column="dislikes" property="dislikes" jdbcType="INTEGER" />
    <result column="job_post_category_id" property="jobPostCategoryId" jdbcType="INTEGER" />
    <result column="member_id" property="memberId" jdbcType="INTEGER" />
    <result column="education_level" property="educationLevel" jdbcType="VARCHAR" />
    <result column="complaint" property="complaint" jdbcType="INTEGER" />
    <result column="work_time" property="workTime" jdbcType="VARCHAR" />
    <result column="salary_unit" property="salaryUnit" jdbcType="VARCHAR" />
    <result column="page_view" property="pageView" jdbcType="INTEGER" />
    <result column="verified" property="verified" jdbcType="VARCHAR" />
    <result column="job_postcol" property="jobPostcol" jdbcType="VARCHAR" />
    <result column="applicant_amount" property="applicantAmount" jdbcType="INTEGER" />

    <association property="member" resultMap="com.fh.taolijie.dao.mapper.MemberModelMapper.BaseResultMap" />
    <association property="category" resultMap="com.fh.taolijie.dao.mapper.JobPostCategoryModelMapper.BaseResultMap" />

  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.fh.taolijie.domain.JobPostModelWithBLOBs" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="introduce" property="introduce" jdbcType="LONGVARCHAR" />
    <result column="application_resume_ids" property="applicationResumeIds" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, title, expired_time, post_time, work_place, wage, time_to_pay, job_description, 
    contact, contact_phone, contact_email, contact_qq, job_detail, likes, dislikes, job_post_category_id, 
    member_id, education_level, complaint, work_time, salary_unit, page_view, verified, 
    job_postcol, applicant_amount
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    introduce, application_resume_ids
  </sql>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from job_post post
    LEFT JOIN member mem ON mem.id = post.member_id
    LEFT JOIN job_post_category cate ON cate.id = post.job_post_category_id
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from job_post
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.fh.taolijie.domain.JobPostModelWithBLOBs" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into job_post (title, expired_time,
      post_time, work_place, wage, 
      time_to_pay, job_description, contact, 
      contact_phone, contact_email, contact_qq, 
      job_detail, likes, dislikes, 
      job_post_category_id, member_id, education_level, 
      complaint, work_time, salary_unit, 
      page_view, verified, job_postcol, 
      applicant_amount, introduce, application_resume_ids
      )
    values (#{title,jdbcType=VARCHAR}, #{expiredTime,jdbcType=DATE},
      #{postTime,jdbcType=DATE}, #{workPlace,jdbcType=VARCHAR}, #{wage,jdbcType=DECIMAL}, 
      #{timeToPay,jdbcType=VARCHAR}, #{jobDescription,jdbcType=VARCHAR}, #{contact,jdbcType=VARCHAR}, 
      #{contactPhone,jdbcType=VARCHAR}, #{contactEmail,jdbcType=VARCHAR}, #{contactQq,jdbcType=VARCHAR}, 
      #{jobDetail,jdbcType=VARCHAR}, #{likes,jdbcType=INTEGER}, #{dislikes,jdbcType=INTEGER}, 
      #{jobPostCategoryId,jdbcType=INTEGER}, #{memberId,jdbcType=INTEGER}, #{educationLevel,jdbcType=VARCHAR}, 
      #{complaint,jdbcType=INTEGER}, #{workTime,jdbcType=VARCHAR}, #{salaryUnit,jdbcType=VARCHAR}, 
      #{pageView,jdbcType=INTEGER}, #{verified,jdbcType=VARCHAR}, #{jobPostcol,jdbcType=VARCHAR}, 
      #{applicantAmount,jdbcType=INTEGER}, #{introduce,jdbcType=LONGVARCHAR}, #{applicationResumeIds,jdbcType=LONGVARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.fh.taolijie.domain.JobPostModelWithBLOBs" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into job_post
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="title != null" >
        title,
      </if>
      <if test="expiredTime != null" >
        expired_time,
      </if>
      <if test="postTime != null" >
        post_time,
      </if>
      <if test="workPlace != null" >
        work_place,
      </if>
      <if test="wage != null" >
        wage,
      </if>
      <if test="timeToPay != null" >
        time_to_pay,
      </if>
      <if test="jobDescription != null" >
        job_description,
      </if>
      <if test="contact != null" >
        contact,
      </if>
      <if test="contactPhone != null" >
        contact_phone,
      </if>
      <if test="contactEmail != null" >
        contact_email,
      </if>
      <if test="contactQq != null" >
        contact_qq,
      </if>
      <if test="jobDetail != null" >
        job_detail,
      </if>
      <if test="likes != null" >
        likes,
      </if>
      <if test="dislikes != null" >
        dislikes,
      </if>
      <if test="jobPostCategoryId != null" >
        job_post_category_id,
      </if>
      <if test="memberId != null" >
        member_id,
      </if>
      <if test="educationLevel != null" >
        education_level,
      </if>
      <if test="complaint != null" >
        complaint,
      </if>
      <if test="workTime != null" >
        work_time,
      </if>
      <if test="salaryUnit != null" >
        salary_unit,
      </if>
      <if test="pageView != null" >
        page_view,
      </if>
      <if test="verified != null" >
        verified,
      </if>
      <if test="jobPostcol != null" >
        job_postcol,
      </if>
      <if test="applicantAmount != null" >
        applicant_amount,
      </if>
      <if test="introduce != null" >
        introduce,
      </if>
      <if test="applicationResumeIds != null" >
        application_resume_ids,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="title != null" >
        #{title,jdbcType=VARCHAR},
      </if>
      <if test="expiredTime != null" >
        #{expiredTime,jdbcType=DATE},
      </if>
      <if test="postTime != null" >
        #{postTime,jdbcType=DATE},
      </if>
      <if test="workPlace != null" >
        #{workPlace,jdbcType=VARCHAR},
      </if>
      <if test="wage != null" >
        #{wage,jdbcType=DECIMAL},
      </if>
      <if test="timeToPay != null" >
        #{timeToPay,jdbcType=VARCHAR},
      </if>
      <if test="jobDescription != null" >
        #{jobDescription,jdbcType=VARCHAR},
      </if>
      <if test="contact != null" >
        #{contact,jdbcType=VARCHAR},
      </if>
      <if test="contactPhone != null" >
        #{contactPhone,jdbcType=VARCHAR},
      </if>
      <if test="contactEmail != null" >
        #{contactEmail,jdbcType=VARCHAR},
      </if>
      <if test="contactQq != null" >
        #{contactQq,jdbcType=VARCHAR},
      </if>
      <if test="jobDetail != null" >
        #{jobDetail,jdbcType=VARCHAR},
      </if>
      <if test="likes != null" >
        #{likes,jdbcType=INTEGER},
      </if>
      <if test="dislikes != null" >
        #{dislikes,jdbcType=INTEGER},
      </if>
      <if test="jobPostCategoryId != null" >
        #{jobPostCategoryId,jdbcType=INTEGER},
      </if>
      <if test="memberId != null" >
        #{memberId,jdbcType=INTEGER},
      </if>
      <if test="educationLevel != null" >
        #{educationLevel,jdbcType=VARCHAR},
      </if>
      <if test="complaint != null" >
        #{complaint,jdbcType=INTEGER},
      </if>
      <if test="workTime != null" >
        #{workTime,jdbcType=VARCHAR},
      </if>
      <if test="salaryUnit != null" >
        #{salaryUnit,jdbcType=VARCHAR},
      </if>
      <if test="pageView != null" >
        #{pageView,jdbcType=INTEGER},
      </if>
      <if test="verified != null" >
        #{verified,jdbcType=VARCHAR},
      </if>
      <if test="jobPostcol != null" >
        #{jobPostcol,jdbcType=VARCHAR},
      </if>
      <if test="applicantAmount != null" >
        #{applicantAmount,jdbcType=INTEGER},
      </if>
      <if test="introduce != null" >
        #{introduce,jdbcType=LONGVARCHAR},
      </if>
      <if test="applicationResumeIds != null" >
        #{applicationResumeIds,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.fh.taolijie.domain.JobPostModelWithBLOBs" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update job_post
    <set >
      <if test="title != null" >
        title = #{title,jdbcType=VARCHAR},
      </if>
      <if test="expiredTime != null" >
        expired_time = #{expiredTime,jdbcType=DATE},
      </if>
      <if test="postTime != null" >
        post_time = #{postTime,jdbcType=DATE},
      </if>
      <if test="workPlace != null" >
        work_place = #{workPlace,jdbcType=VARCHAR},
      </if>
      <if test="wage != null" >
        wage = #{wage,jdbcType=DECIMAL},
      </if>
      <if test="timeToPay != null" >
        time_to_pay = #{timeToPay,jdbcType=VARCHAR},
      </if>
      <if test="jobDescription != null" >
        job_description = #{jobDescription,jdbcType=VARCHAR},
      </if>
      <if test="contact != null" >
        contact = #{contact,jdbcType=VARCHAR},
      </if>
      <if test="contactPhone != null" >
        contact_phone = #{contactPhone,jdbcType=VARCHAR},
      </if>
      <if test="contactEmail != null" >
        contact_email = #{contactEmail,jdbcType=VARCHAR},
      </if>
      <if test="contactQq != null" >
        contact_qq = #{contactQq,jdbcType=VARCHAR},
      </if>
      <if test="jobDetail != null" >
        job_detail = #{jobDetail,jdbcType=VARCHAR},
      </if>
      <if test="likes != null" >
        likes = #{likes,jdbcType=INTEGER},
      </if>
      <if test="dislikes != null" >
        dislikes = #{dislikes,jdbcType=INTEGER},
      </if>
      <if test="jobPostCategoryId != null" >
        job_post_category_id = #{jobPostCategoryId,jdbcType=INTEGER},
      </if>
      <if test="memberId != null" >
        member_id = #{memberId,jdbcType=INTEGER},
      </if>
      <if test="educationLevel != null" >
        education_level = #{educationLevel,jdbcType=VARCHAR},
      </if>
      <if test="complaint != null" >
        complaint = #{complaint,jdbcType=INTEGER},
      </if>
      <if test="workTime != null" >
        work_time = #{workTime,jdbcType=VARCHAR},
      </if>
      <if test="salaryUnit != null" >
        salary_unit = #{salaryUnit,jdbcType=VARCHAR},
      </if>
      <if test="pageView != null" >
        page_view = #{pageView,jdbcType=INTEGER},
      </if>
      <if test="verified != null" >
        verified = #{verified,jdbcType=VARCHAR},
      </if>
      <if test="jobPostcol != null" >
        job_postcol = #{jobPostcol,jdbcType=VARCHAR},
      </if>
      <if test="applicantAmount != null" >
        applicant_amount = #{applicantAmount,jdbcType=INTEGER},
      </if>
      <if test="introduce != null" >
        introduce = #{introduce,jdbcType=LONGVARCHAR},
      </if>
      <if test="applicationResumeIds != null" >
        application_resume_ids = #{applicationResumeIds,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.fh.taolijie.domain.JobPostModelWithBLOBs" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update job_post
    set title = #{title,jdbcType=VARCHAR},
      expired_time = #{expiredTime,jdbcType=DATE},
      post_time = #{postTime,jdbcType=DATE},
      work_place = #{workPlace,jdbcType=VARCHAR},
      wage = #{wage,jdbcType=DECIMAL},
      time_to_pay = #{timeToPay,jdbcType=VARCHAR},
      job_description = #{jobDescription,jdbcType=VARCHAR},
      contact = #{contact,jdbcType=VARCHAR},
      contact_phone = #{contactPhone,jdbcType=VARCHAR},
      contact_email = #{contactEmail,jdbcType=VARCHAR},
      contact_qq = #{contactQq,jdbcType=VARCHAR},
      job_detail = #{jobDetail,jdbcType=VARCHAR},
      likes = #{likes,jdbcType=INTEGER},
      dislikes = #{dislikes,jdbcType=INTEGER},
      job_post_category_id = #{jobPostCategoryId,jdbcType=INTEGER},
      member_id = #{memberId,jdbcType=INTEGER},
      education_level = #{educationLevel,jdbcType=VARCHAR},
      complaint = #{complaint,jdbcType=INTEGER},
      work_time = #{workTime,jdbcType=VARCHAR},
      salary_unit = #{salaryUnit,jdbcType=VARCHAR},
      page_view = #{pageView,jdbcType=INTEGER},
      verified = #{verified,jdbcType=VARCHAR},
      job_postcol = #{jobPostcol,jdbcType=VARCHAR},
      applicant_amount = #{applicantAmount,jdbcType=INTEGER},
      introduce = #{introduce,jdbcType=LONGVARCHAR},
      application_resume_ids = #{applicationResumeIds,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.fh.taolijie.domain.JobPostModel" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update job_post
    set title = #{title,jdbcType=VARCHAR},
      expired_time = #{expiredTime,jdbcType=DATE},
      post_time = #{postTime,jdbcType=DATE},
      work_place = #{workPlace,jdbcType=VARCHAR},
      wage = #{wage,jdbcType=DECIMAL},
      time_to_pay = #{timeToPay,jdbcType=VARCHAR},
      job_description = #{jobDescription,jdbcType=VARCHAR},
      contact = #{contact,jdbcType=VARCHAR},
      contact_phone = #{contactPhone,jdbcType=VARCHAR},
      contact_email = #{contactEmail,jdbcType=VARCHAR},
      contact_qq = #{contactQq,jdbcType=VARCHAR},
      job_detail = #{jobDetail,jdbcType=VARCHAR},
      likes = #{likes,jdbcType=INTEGER},
      dislikes = #{dislikes,jdbcType=INTEGER},
      job_post_category_id = #{jobPostCategoryId,jdbcType=INTEGER},
      member_id = #{memberId,jdbcType=INTEGER},
      education_level = #{educationLevel,jdbcType=VARCHAR},
      complaint = #{complaint,jdbcType=INTEGER},
      work_time = #{workTime,jdbcType=VARCHAR},
      salary_unit = #{salaryUnit,jdbcType=VARCHAR},
      page_view = #{pageView,jdbcType=INTEGER},
      verified = #{verified,jdbcType=VARCHAR},
      job_postcol = #{jobPostcol,jdbcType=VARCHAR},
      applicant_amount = #{applicantAmount,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>

  <select id="getAll" resultMap="BaseResultMap">
    SELECT * FROM job_post post
      LEFT JOIN member mem ON mem.id = post.member_id
      LEFT JOIN job_post_category cate ON cate.id = post.job_post_category_id
    ORDER BY
      post.post_time
    LIMIT
      #{pageNumber}, #{pageSize}
  </select>

  <select id="getInBatch" resultMap="BaseResultMap">
    SELECT * FROM job_post post
      LEFT JOIN member mem ON mem.id = post.member_id
      LEFT JOIN job_post_category cate ON cate.id = post.job_post_category_id
    WHERE
      post.id IN
      <foreach collection="list" item="id" open="(" separator="," close=")">#{id}</foreach>
  </select>

  <select id="getByComplaint" resultMap="BaseResultMap">
    SELECT * FROM job_post post
      LEFT JOIN member mem ON mem.id = post.member_id
      LEFT JOIN job_post_category cate ON cate.id = post.job_post_category_id
    WHERE
      post.complaint IS NOT NULL AND post.complaint > 0
    ORDER BY
      post.complaint DESC
    LIMIT
      #{pageNumber}, #{pageSize}
  </select>

  <select id="findBy" resultMap="BaseResultMap">
    SELECT * FROM job_post post
      LEFT JOIN member mem ON mem.id = post.member_id
      LEFT JOIN job_post_category cate ON cate.id = post.job_post_category_id
    <where>
      <if test="title != null" >
        title = #{title,jdbcType=VARCHAR}
      </if>
      <if test="expiredTime != null" >
        AND expired_time = #{expiredTime,jdbcType=DATE}
      </if>
      <if test="postTime != null" >
        AND post_time = #{postTime,jdbcType=DATE}
      </if>
      <if test="workPlace != null" >
        AND work_place = #{workPlace,jdbcType=VARCHAR}
      </if>
      <if test="wage != null" >
        AND wage = #{wage,jdbcType=DECIMAL}
      </if>
      <if test="timeToPay != null" >
        AND time_to_pay = #{timeToPay,jdbcType=VARCHAR}
      </if>
      <if test="jobDescription != null" >
        AND job_description = #{jobDescription,jdbcType=VARCHAR}
      </if>
      <if test="contact != null" >
        AND contact = #{contact,jdbcType=VARCHAR}
      </if>
      <if test="contactPhone != null" >
        AND contact_phone = #{contactPhone,jdbcType=VARCHAR}
      </if>
      <if test="contactEmail != null" >
        AND contact_email = #{contactEmail,jdbcType=VARCHAR}
      </if>
      <if test="contactQq != null" >
        AND contact_qq = #{contactQq,jdbcType=VARCHAR}
      </if>
      <if test="jobDetail != null" >
        AND job_detail = #{jobDetail,jdbcType=VARCHAR}
      </if>
      <if test="likes != null" >
        AND likes = #{likes,jdbcType=INTEGER}
      </if>
      <if test="dislikes != null" >
        AND dislikes = #{dislikes,jdbcType=INTEGER}
      </if>
      <if test="jobPostCategoryId != null" >
        AND job_post_category_id = #{jobPostCategoryId,jdbcType=INTEGER}
      </if>
      <if test="memberId != null" >
        AND member_id = #{memberId,jdbcType=INTEGER}
      </if>
      <if test="educationLevel != null" >
        AND education_level = #{educationLevel,jdbcType=VARCHAR}
      </if>
      <if test="complaint != null" >
        AND complaint = #{complaint,jdbcType=INTEGER}
      </if>
      <if test="workTime != null" >
        AND work_time = #{workTime,jdbcType=VARCHAR}
      </if>
      <if test="salaryUnit != null" >
        AND salary_unit = #{salaryUnit,jdbcType=VARCHAR}
      </if>
      <if test="pageView != null" >
        AND page_view = #{pageView,jdbcType=INTEGER}
      </if>
      <if test="verified != null" >
        AND verified = #{verified,jdbcType=VARCHAR}
      </if>
      <if test="jobPostcol != null" >
        AND job_postcol = #{jobPostcol,jdbcType=VARCHAR}
      </if>
      <if test="applicantAmount != null" >
        AND applicant_amount = #{applicantAmount,jdbcType=INTEGER}
      </if>
      <if test="introduce != null" >
        AND introduce = #{introduce,jdbcType=LONGVARCHAR}
      </if>
      <if test="applicationResumeIds != null" >
        AND application_resume_ids = #{applicationResumeIds,jdbcType=LONGVARCHAR}
      </if>

    </where>
    ORDER BY
      <choose>
        <when test="orderByDate == true">post.postTime DESC</when>
        <when test="orderByVisit == true">post.pageView DESC</when>
        <otherwise>post.postTime DESC</otherwise>
      </choose>
    LIMIT
      #{pageNumber}, #{pageSize}
  </select>

  <update id="complaint">
    UPDATE job_post SET complaint = complaint + 1 WHERE id = #{postId}
  </update>

  <update id="increasePageView">
    UPDATE job_post SET page_view = page_view + 1 WHERE id = #{postId}
  </update>
</mapper>