<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fh.taolijie.dao.mapper.ResumeModelMapper">
    <resultMap id="BaseResultMap" type="com.fh.taolijie.domain.ResumeModel">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="resume_id" property="id" jdbcType="INTEGER"/>
        <result column="resume_name" property="name" jdbcType="VARCHAR"/>
        <result column="resume_gender" property="gender" jdbcType="VARCHAR"/>
        <result column="resume_age" property="age" jdbcType="INTEGER"/>
        <result column="resume_height" property="height" jdbcType="INTEGER"/>
        <result column="resume_photo_path" property="photoPath" jdbcType="VARCHAR"/>
        <result column="resume_email" property="email" jdbcType="VARCHAR"/>
        <result column="resume_qq" property="qq" jdbcType="VARCHAR"/>
        <result column="resume_member_id" property="memberId" jdbcType="INTEGER"/>
        <result column="resume_access_authority" property="accessAuthority" jdbcType="VARCHAR"/>
        <result column="resume_page_view" property="pageView" jdbcType="INTEGER"/>
        <result column="resume_verified" property="verified" jdbcType="VARCHAR"/>
        <result column="resume_created_time" property="createdTime"/>
        <result column="resume_photo_id" property="photoId" jdbcType="INTEGER"/>
        <result column="resume_phone_number" property="phoneNumber" jdbcType="VARCHAR"/>
        <result column="resume_wechat_account" property="wechatAccount" jdbcType="VARCHAR"/>

        <result column="resume_experience" property="experience" jdbcType="LONGVARCHAR"/>
        <result column="resume_introduce" property="introduce" jdbcType="LONGVARCHAR"/>

        <association property="member" resultMap="com.fh.taolijie.dao.mapper.MemberModelMapper.BaseResultMap"/>
    </resultMap>

    <resultMap id="PostRecord" type="com.fh.taolijie.domain.middle.ResumePostRecord">
        <association property="jobPost" resultMap="com.fh.taolijie.dao.mapper.JobPostModelMapper.BaseResultMap"/>
        <association property="member" resultMap="com.fh.taolijie.dao.mapper.MemberModelMapper.BaseResultMap"/>
        <association property="resume" resultMap="BaseResultMap"/>
    </resultMap>

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id AS resume_id, name AS resume_name, gender AS resume_gender, age AS resume_age,
        height AS resume_height, photo_path AS resume_photo_path, email AS resume_email,
        qq AS resume_qq, member_id AS resume_member_id, access_authority AS resume_access_authority,
        page_view AS resume_page_view, verified AS resume_verified, photo_id AS resume_photo_id,
        phone_number AS resume_phone_number, wechat_account AS resume_wechat_account, created_time AS resume_created_time,
        experience AS resume_experience, introduce AS resume_introduce
    </sql>

    <sql id="resume_column">
        re.id AS resume_id, re.name AS resume_name, re.gender AS resume_gender, re.age AS resume_age,
        re.height AS resume_height, re.photo_path AS resume_photo_path, re.email AS resume_email,
        re.qq AS resume_qq, re.member_id AS resume_member_id, re.access_authority AS resume_access_authority,
        re.page_view AS resume_page_view, re.verified AS resume_verified, re.photo_id AS resume_photo_id,
        re.phone_number AS resume_phone_number, re.wechat_account AS resume_wechat_account, re.created_time AS resume_created_time,
        re.experience AS resume_experience, re.introduce AS resume_introduce

    </sql>

    <sql id="member_column">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        mem.id AS mem_id, mem.username AS mem_username, mem.password AS mem_password, mem.email AS mem_email, mem.name AS mem_name, mem.gender AS mem_gender, mem.verified AS mem_verified, mem.profile_photo_path AS mem_profile_photo_path, mem.phone AS mem_phone,
        mem.qq AS mem_qq, mem.age AS mem_age, mem.company_name AS mem_company_name, mem.created_time AS mem_created_time, mem.valid AS mem_valid, mem.complaint AS mem_complaint, mem.profile_photo_id AS mem_profile_photo_id, mem.auto_login_identifier AS mem_auto_login_identifier,
        mem.last_post_time AS mem_last_post_time, mem.reset_password_token AS mem_reset_password_token, mem.last_token_date AS mem_last_token_date, mem.school_organization AS mem_school_organization, mem.creadits AS mem_creadits,
        mem.student_id AS mem_student_id, mem.block_list AS mem_block_list, mem.applied_job_ids AS mem_applied_job_ids, mem.liked_job_ids AS mem_liked_job_ids, mem.liked_sh_ids AS mem_liked_sh_ids, mem.favorite_job_ids AS mem_favorite_job_ids,
        mem.favorite_sh_ids AS mem_favorite_sh_ids, mem.favorite_resume_ids AS mem_favorite_resume_ids,mem.read_global_noti_ids AS mem_read_global_noti_ids
    </sql>

    <sql id="job_post_column">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        post.id AS job_id, post.title AS job_title, post.expired_time  AS job_expired_time, post.post_time AS job_post_time, post.work_place AS job_work_place, post.wage AS job_wage, post.time_to_pay AS job_time_to_pay,
        post.job_description AS job_job_description,
        post.contact AS job_contact, post.contact_phone AS job_contact_phone, post.contact_email AS job_contact_email, post.contact_qq AS job_contact_qq, post.job_detail AS job_job_detail, post.likes AS job_likes,
        post.dislikes AS job_dislikes, post.job_post_category_id AS job_job_post_category_id,
        post.member_id AS job_member_id, post.education_level AS job_education_level, post.complaint AS job_complaint, post.work_time AS job_work_time, post.salary_unit AS job_salary_unit, post.page_view AS job_page_view,
        post.verified AS job_verified,
        post.job_postcol AS job_job_postcol, post.applicant_amount AS job_applicant_amount, post.introduce AS job_introduce, post.application_resume_ids AS job_application_resume_ids,
        post.deleted AS job_deleted
    </sql>

    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
            <include refid="resume_column"/>,
            <include refid="member_column"/>
        from resume re
            LEFT JOIN member mem ON mem.id = re.member_id
        where re.id = #{id,jdbcType=INTEGER}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        DELETE FROM resume
        WHERE id = #{id,jdbcType=INTEGER}
    </delete>
    <insert id="insert">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        INSERT INTO resume (name, gender,
        age, height, photo_path,
        email, qq, member_id,
        access_authority, page_view, verified,
        photo_id, phone_number, wechat_account,
        experience, introduce, created_time)
        VALUES (#{name,jdbcType=VARCHAR}, #{gender,jdbcType=VARCHAR},
        #{age,jdbcType=INTEGER}, #{height,jdbcType=INTEGER}, #{photoPath,jdbcType=VARCHAR},
        #{email,jdbcType=VARCHAR}, #{qq,jdbcType=VARCHAR}, #{memberId,jdbcType=INTEGER},
        #{accessAuthority,jdbcType=VARCHAR}, #{pageView,jdbcType=INTEGER}, #{verified,jdbcType=VARCHAR},
        #{photoId,jdbcType=INTEGER}, #{phoneNumber,jdbcType=VARCHAR}, #{wechatAccount,jdbcType=VARCHAR},
        #{experience,jdbcType=LONGVARCHAR}, #{introduce,jdbcType=LONGVARCHAR}, #{createdTime})
    </insert>
    <insert id="insertSelective">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into resume
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="name != null">
                name,
            </if>
            <if test="gender != null">
                gender,
            </if>
            <if test="age != null">
                age,
            </if>
            <if test="height != null">
                height,
            </if>
            <if test="photoPath != null">
                photo_path,
            </if>
            <if test="email != null">
                email,
            </if>
            <if test="qq != null">
                qq,
            </if>
            <if test="memberId != null">
                member_id,
            </if>
            <if test="accessAuthority != null">
                access_authority,
            </if>
            <if test="pageView != null">
                page_view,
            </if>
            <if test="verified != null">
                verified,
            </if>
            <if test="photoId != null">
                photo_id,
            </if>
            <if test="phoneNumber != null">
                phone_number,
            </if>
            <if test="wechatAccount != null">
                wechat_account,
            </if>
            <if test="experience != null">
                experience,
            </if>
            <if test="introduce != null">
                introduce,
            </if>
            <if test="createdTime != null">
                created_time
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="name != null">
                #{name,jdbcType=VARCHAR},
            </if>
            <if test="gender != null">
                #{gender,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                #{age,jdbcType=INTEGER},
            </if>
            <if test="height != null">
                #{height,jdbcType=INTEGER},
            </if>
            <if test="photoPath != null">
                #{photoPath,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                #{email,jdbcType=VARCHAR},
            </if>
            <if test="qq != null">
                #{qq,jdbcType=VARCHAR},
            </if>
            <if test="memberId != null">
                #{memberId,jdbcType=INTEGER},
            </if>
            <if test="accessAuthority != null">
                #{accessAuthority,jdbcType=VARCHAR},
            </if>
            <if test="pageView != null">
                #{pageView,jdbcType=INTEGER},
            </if>
            <if test="verified != null">
                #{verified,jdbcType=VARCHAR},
            </if>
            <if test="photoId != null">
                #{photoId,jdbcType=INTEGER},
            </if>
            <if test="phoneNumber != null">
                #{phoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="wechatAccount != null">
                #{wechatAccount,jdbcType=VARCHAR},
            </if>
            <if test="experience != null">
                #{experience,jdbcType=LONGVARCHAR},
            </if>
            <if test="introduce != null">
                #{introduce,jdbcType=LONGVARCHAR},
            </if>
            <if test="createdTime != null">
                #{createdTime}
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update resume
        <set>
            <if test="name != null">
                name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="gender != null">
                gender = #{gender,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                age = #{age,jdbcType=INTEGER},
            </if>
            <if test="height != null">
                height = #{height,jdbcType=INTEGER},
            </if>
            <if test="photoPath != null">
                photo_path = #{photoPath,jdbcType=VARCHAR},
            </if>
            <if test="email != null">
                email = #{email,jdbcType=VARCHAR},
            </if>
            <if test="qq != null">
                qq = #{qq,jdbcType=VARCHAR},
            </if>
            <if test="memberId != null">
                member_id = #{memberId,jdbcType=INTEGER},
            </if>
            <if test="accessAuthority != null">
                access_authority = #{accessAuthority,jdbcType=VARCHAR},
            </if>
            <if test="pageView != null">
                page_view = #{pageView,jdbcType=INTEGER},
            </if>
            <if test="verified != null">
                verified = #{verified,jdbcType=VARCHAR},
            </if>
            <if test="photoId != null">
                photo_id = #{photoId,jdbcType=INTEGER},
            </if>
            <if test="phoneNumber != null">
                phone_number = #{phoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="wechatAccount != null">
                wechat_account = #{wechatAccount,jdbcType=VARCHAR},
            </if>
            <if test="experience != null">
                experience = #{experience,jdbcType=LONGVARCHAR},
            </if>
            <if test="introduce != null">
                introduce = #{introduce,jdbcType=LONGVARCHAR},
            </if>
            <if test="createdTime != null">
                created_time = #{createdTime}
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.fh.taolijie.domain.ResumeModel">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        UPDATE resume
        SET name = #{name,jdbcType=VARCHAR},
        gender = #{gender,jdbcType=VARCHAR},
        age = #{age,jdbcType=INTEGER},
        height = #{height,jdbcType=INTEGER},
        photo_path = #{photoPath,jdbcType=VARCHAR},
        email = #{email,jdbcType=VARCHAR},
        qq = #{qq,jdbcType=VARCHAR},
        member_id = #{memberId,jdbcType=INTEGER},
        access_authority = #{accessAuthority,jdbcType=VARCHAR},
        page_view = #{pageView,jdbcType=INTEGER},
        verified = #{verified,jdbcType=VARCHAR},
        photo_id = #{photoId,jdbcType=INTEGER},
        phone_number = #{phoneNumber,jdbcType=VARCHAR},
        wechat_account = #{wechatAccount,jdbcType=VARCHAR},
        experience = #{experience,jdbcType=LONGVARCHAR},
        introduce = #{introduce,jdbcType=LONGVARCHAR},
        created_time = #{createdTime}
        WHERE id = #{id,jdbcType=INTEGER}
    </update>

    <select id="getAll" resultMap="BaseResultMap">
        SELECT
            <include refid="resume_column"/>,
            <include refid="member_column"/>
        FROM resume re
            LEFT JOIN member mem ON mem.id = re.member_id
        LIMIT
            #{pageNumber}, #{pageSize}
    </select>

    <select id="getInBatch" resultMap="BaseResultMap">
        SELECT
            <include refid="resume_column"/>,
            <include refid="member_column"/>
        FROM resume re
            LEFT JOIN member mem ON mem.id = re.member_id
        WHERE re.id IN
        <foreach collection="list" item="id" open="(" close=")" separator="," >#{id}</foreach>
    </select>

    <update id="updateTime">
        UPDATE resume
        SET created_time = now()
        WHERE id = #{resumeId}
    </update>

    <update id="increasePageView">
        UPDATE resume
        SET page_view = page_view + 1
        WHERE id = #{resumeId}
    </update>

    <select id="findBy" resultMap="BaseResultMap">
        SELECT
            <include refid="resume_column"/>,
            <include refid="member_column"/>
        FROM resume re
            INNER JOIN member mem ON mem.id = re.member_id
        <where>
            <if test="name != null">
                re.name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="gender != null">
                AND re.gender = #{gender,jdbcType=VARCHAR}
            </if>
            <if test="age != null">
                AND re.age = #{age,jdbcType=INTEGER}
            </if>
            <if test="height != null">
                AND re.height = #{height,jdbcType=INTEGER}
            </if>
            <if test="photoPath != null">
                AND re.photo_path = #{photoPath,jdbcType=VARCHAR}
            </if>
            <if test="email != null">
                AND re.email = #{email,jdbcType=VARCHAR}
            </if>
            <if test="qq != null">
                AND re.qq = #{qq,jdbcType=VARCHAR}
            </if>
            <if test="memberId != null">
                AND re.member_id = #{memberId,jdbcType=INTEGER}
            </if>
            <if test="accessAuthority != null">
                AND re.access_authority = #{accessAuthority,jdbcType=VARCHAR}
            </if>
            <if test="pageView != null">
                AND re.page_view = #{pageView,jdbcType=INTEGER}
            </if>
            <if test="verified != null">
                AND re.verified = #{verified,jdbcType=VARCHAR}
            </if>
            <if test="photoId != null">
                AND re.photo_id = #{photoId,jdbcType=INTEGER}
            </if>
            <if test="phoneNumber != null">
                AND re.phone_number = #{phoneNumber,jdbcType=VARCHAR},
            </if>
            <if test="wechatAccount != null">
                AND re.wechat_account = #{wechatAccount,jdbcType=VARCHAR}
            </if>
            <if test="experience != null">
                AND re.experience = #{experience,jdbcType=LONGVARCHAR}
            </if>
            <if test="introduce != null">
                AND re.introduce = #{introduce,jdbcType=LONGVARCHAR}
            </if>
            <if test="createdTime != null">
                AND re.created_time = #{createdTime}
            </if>
        </where>
        LIMIT
        #{pageNumber}, #{pageSize}
    </select>

    <select id="findPostRecordByMember" resultMap="PostRecord">
        SELECT
            <include refid="member_column"/>,
            <include refid="resume_column"/>,
            <include refid="job_post_column"/>
        FROM
            resume_post_rel rp
              INNER JOIN
                member mem ON mem.id = rp.member_id
              INNER JOIN
                job_post post ON post.id = rp.job_post_id
              INNER JOIN
                resume re ON re.id = rp.resume_id
        WHERE
            re.member_id = #{memberId}
        LIMIT
            #{pageNumber}, #{pageSize}
    </select>
</mapper>